<!DOCTYPE html>
<html>
<head>
    <title>Binance Brief</title>
    <meta charset="UTF-8">
    <style>
        body { background: #0a0a0a; color: #f0b90b; font-family: Arial; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .card { background: #1e1f25; padding: 40px; border-radius: 20px; width: 500px; border: 1px solid #2c2f36; }
        input { width: 100%; padding: 15px; margin: 10px 0; background: #0c0f15; border: 1px solid #2c2f36; color: white; border-radius: 10px; }
        button { background: #f0b90b; color: black; padding: 15px; border: none; border-radius: 10px; font-weight: bold; width: 100%; margin: 5px 0; cursor: pointer; }
        .participant { display: flex; justify-content: space-between; padding: 10px; background: #0c0f15; margin: 5px 0; border-radius: 8px; }
        .status { background: #0c0f15; padding: 10px; border-radius: 8px; margin: 10px 0; text-align: center; }
    </style>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É (—Ä–∞–±–æ—á–∞—è —Å—Å—ã–ª–∫–∞) -->
    <script src="https://unpkg.com/livekit-client@1.15.4/dist/livekit-client.umd.js"></script>
</head>
<body>
    <div class="card">
        <h2>üîä Binance Brief</h2>
        
        <div id="login">
            <input type="text" id="room" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã" value="test123">
            <input type="text" id="name" placeholder="–í–∞—à–µ –∏–º—è" value="User">
            <button onclick="connect()">üöÄ –í–æ–π—Ç–∏</button>
        </div>

        <div id="room" style="display:none;">
            <div class="status" id="connStatus">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</div>
            <div id="users"></div>
            <button onclick="toggleMic()" id="micBtn">üé§ –ú–∏–∫—Ä–æ—Ñ–æ–Ω</button>
            <button onclick="disconnect()">üö™ –í—ã–π—Ç–∏</button>
        </div>
    </div>

    <script>
        const url = 'wss://testzvonok-3q10z44j.livekit.cloud';
        let currentRoom = null;

        window.connect = async function() {
            const roomName = document.getElementById('room').value;
            const userName = document.getElementById('name').value;
            
            document.getElementById('login').style.display = 'none';
            document.getElementById('room').style.display = 'block';
            
            try {
                const room = new LiveKitClient.Room();
                currentRoom = room;
                
                room.on(LiveKitClient.RoomEvent.ParticipantConnected, updateUsers);
                room.on(LiveKitClient.RoomEvent.ParticipantDisconnected, updateUsers);
                
                await room.connect(url, '', { identity: userName, roomName: roomName });
                await room.localParticipant.setMicrophoneEnabled(true);
                
                document.getElementById('connStatus').innerHTML = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ';
                updateUsers();
                
            } catch(e) {
                document.getElementById('connStatus').innerHTML = '‚ùå ' + e.message;
            }
        }

        function updateUsers() {
            if(!currentRoom) return;
            const list = [currentRoom.localParticipant, ...currentRoom.participants.values()];
            let html = '<h3>–£—á–∞—Å—Ç–Ω–∏–∫–∏:</h3>';
            list.forEach(p => {
                html += `<div class="participant">üë§ ${p.identity}</div>`;
            });
            document.getElementById('users').innerHTML = html;
        }

        window.toggleMic = async function() {
            if(!currentRoom) return;
            const state = !currentRoom.localParticipant.isMicrophoneEnabled;
            await currentRoom.localParticipant.setMicrophoneEnabled(state);
        }

        window.disconnect = function() {
            if(currentRoom) currentRoom.disconnect();
            location.reload();
        }
    </script>
</body>
</html>
